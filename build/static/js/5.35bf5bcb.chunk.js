(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{704:function(e,t,o){"use strict";o.r(t);var a,n,r=o(0),i=o.n(r),l=o(31),s=o(55),c=o(44),u=o(23),p=o(42),d=o.n(p),m=o(63),b=o(329),f=o(327),E=o(87),v=o(48),g=o(30),h=o.n(g),w=o(65),x=o.n(w),C=o(14),S=o(15),y=S.c.div(a||(a=Object(C.a)(["\n  & .users-table {\n    & table {\n      border-collapse: separate;\n      border-spacing: 0 0.3rem;\n    }\n    & .ant-table-selection,\n    .ant-checkbox-wrapper {\n      display: none;\n    }\n    & tr {\n      height: 5rem;\n      font-size: 17px;\n      &:hover > td {\n        background-color: #6bb1c5;\n      }\n    }\n    & thead tr th {\n      background-color: #0a1128;\n      color: #fefcfb;\n    }\n    & tr td {\n      background-color: #0a1128;\n      color: #fefcfb;\n    }\n    & tr td:first-child,\n    tr th:first-child {\n      border-top-left-radius: 0.3rem;\n      border-bottom-left-radius: 0.3rem;\n    }\n    & tr td:last-child,\n    tr th:last-child {\n      border-top-right-radius: 0.3rem;\n      border-bottom-right-radius: 0.3rem;\n    }\n    & .ant-table-column-has-sorters:hover {\n      background-color: #6bb1c5;\n    }\n    & td div div {\n      &:first-child {\n        a path {\n          fill: #3d6e9c;\n        }\n      }\n      &:last-child {\n        a path {\n          fill: #c56b6b;\n        }\n      }\n      & a {\n        padding: 0rem 0rem;\n        border: none;\n        border-radius: 0.2rem;\n        font-weight: 400;\n        text-decoration: none;\n      }\n    }\n  }\n"]))),k=S.c.a(n||(n=Object(C.a)(["\n  display: block;\n  width: 160px;\n  height: 45px;\n  background: #6bb1c5;\n  padding: 10px;\n  margin-bottom: 2rem;\n  text-align: center;\n  border-radius: 5px;\n  color: white;\n  font-weight: bold;\n  background-color: #6bb1c5;\n  text-decoration: none;\n  box-shadow: 0rem 0.2rem 0.2rem 0rem #bdbdbd;\n  float: right;\n  &:hover {\n    color: white;\n  }\n"]))),B=o(449),U=o.n(B),O=o(20),A=o(21),_=[{title:"Usuario",dataIndex:"nombreUsuario"},{title:"Nombre",dataIndex:"nombre"},{title:"Apellidos",dataIndex:"apellidos"},{title:"Grupo",dataIndex:"grupo"},{title:"Email",dataIndex:"email"},{title:"Rol",dataIndex:"rol"},{title:"",key:"accion",width:300,dataIndex:"accion",render:function(e,t){return i.a.createElement(b.b,{size:"middle"},i.a.createElement("a",{title:"Contrase\xf1a",onClick:function(e){j(t.nombre,t.apellidos,t.idUsuario)}},i.a.createElement(O.a,{icon:A.e,className:"view-icon"})),i.a.createElement("a",{href:"http://localhost:3000/usuarios",title:"Editar",onClick:function(e){z(t.id,t.nombre,t.apellidos,t.email,t.nombreUsuario,t.idUsuario,t.rol,t.id_grupo,t.grupo,e)}},i.a.createElement(O.a,{icon:A.c,className:"edit-icon"})),i.a.createElement("a",{href:"http://localhost:3000/usuarios",title:"Eliminar",onClick:function(e){T(t.idUsuario)}},i.a.createElement(O.a,{icon:A.g,className:"delete-icon"})))}}],q=function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h()({title:"Se enviar\xe1 un mail al usuario para que se valide ...",icon:x.a,button:!1,allowOutsideClick:!1}),e.next=3,v.a.get("update-pw/".concat(t)).then(function(e){e.status>=200&&e.status<=205&&window.location.reload(!0)}).catch(function(e){401==e.status?h()({title:"Error acceso "+e.response.status,text:"Error, no tienes acceso a esta secci\xf3n.",icon:"error",button:"Aceptar",timer:"3000"}):h()({title:"Error interno "+e.response.status,text:"Error interno, vuelve a intentarlo en unos momentos.",icon:"error",button:"Aceptar",timer:"3000"})});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(m.a)(d.a.mark(function e(t,o,a){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:U.a.fire({title:"Solicitud de nueva contrase\xf1a",html:"\xbf Seguro que deseas solicitar una nueva contrase\xf1a para <b> ".concat(t," ").concat(o," </b> ?<br>&nbsp;<br>\n    Esta acci\xf3n dejar\xe1 el usuario inhabilitado hasta que actualice su contrase\xf1a."),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Solicitar",cancelButtonText:"Cancelar",focusConfirm:!1}).then(function(e){e.isConfirmed&&q(a)});case 1:case"end":return e.stop()}},e)}));return function(t,o,a){return e.apply(this,arguments)}}(),N=function(){var e=Object(m.a)(d.a.mark(function e(){var t,o,a,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.parse(localStorage.getItem("user")),o='<option value="al" selected="">Alumno</option>',t.es_admin&&(o='<option value="al" selected="">Alumno</option>\n    <option value="pr">Profesor</option>'),e.next=5,J("Profesor",0,"");case 5:a=e.sent,n=[],"",U.a.fire({title:"Crear usuario",html:"<label for='EnombreUsuario'>Nombre inicio sesi\xf3n:</label>\n    <input class=\"swal2-input\" id='EnombreUsuario' type='text' placeholder=\"Nombre usuario\">\n    <label for='Epassword'>Password:</label>\n    <input class=\"swal2-input\" id='Epassword' type='password' placeholder=\"Contrase\xf1a\">\n    <label for='Enombre'>Nombre:</label>\n    <input class=\"swal2-input\" id='Enombre' type='text' placeholder=\"Nombre\">\n    <label for='Eapellidos'>Apellidos:</label>\n    <input class=\"swal2-input\" id='Eapellidos' type='text' placeholder=\"Apellidos\">\n    <label for='Eemail'>Email:</label>\n    <input class=\"swal2-input\" id='Eemail' type='email' placeholder=\"Email\">\n    <label for=\"Etipo\">Tipo usuario:</label><br>\n    <select class=\"swal2-input\" id=\"Etipo\">\n    ".concat(o,"\n    </select>"),showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Crear",cancelButtonText:"Cancelar",focusConfirm:!1,preConfirm:function(){var e=U.a.getPopup().querySelector("#Enombre").value,t=U.a.getPopup().querySelector("#Eapellidos").value,o=U.a.getPopup().querySelector("#Eemail").value,a=U.a.getPopup().querySelector("#EnombreUsuario").value,n=U.a.getPopup().querySelector("#Epassword").value,r=U.a.getPopup().querySelector("#Etipo").value;return e&&t&&o&&a&&n?(a.length<6||n.length<6)&&U.a.showValidationMessage("Nombre de usuario o password inferior a 6 digitos"):U.a.showValidationMessage("Alg\xfan campo obligatorio vac\xedo"),{Enombre:e,Eapellidos:t,Eemail:o,EnombreUsuario:a,Epassword:n,Etipo:r}}}).then(function(e){e.isConfirmed&&("al"==e.value.Etipo?U.a.fire({title:"Quieres asignarle un grupo",html:"".concat(a),icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Asignar",cancelButtonText:"Continuar sin asignar",preConfirm:function(){return{Egrupo:U.a.getPopup().querySelector("#Egrupo").value}}}).then(function(t){n=t.isConfirmed?"-1"==t.value.Egrupo?{nombre:"".concat(e.value.Enombre),apellidos:"".concat(e.value.Eapellidos),email:"".concat(e.value.Eemail),username:"".concat(e.value.EnombreUsuario),password:"".concat(e.value.Epassword),password_confirmation:"".concat(e.value.Epassword),id_grupo:null}:{nombre:"".concat(e.value.Enombre),apellidos:"".concat(e.value.Eapellidos),email:"".concat(e.value.Eemail),username:"".concat(e.value.EnombreUsuario),password:"".concat(e.value.Epassword),password_confirmation:"".concat(e.value.Epassword),id_grupo:"".concat(t.value.Egrupo)}:{nombre:"".concat(e.value.Enombre),apellidos:"".concat(e.value.Eapellidos),email:"".concat(e.value.Eemail),username:"".concat(e.value.EnombreUsuario),password:"".concat(e.value.Epassword),password_confirmation:"".concat(e.value.Epassword),id_grupo:null},I(n,"register-alumno")}):t.es_admin&&U.a.fire({title:"\xbfQuieres que sea administrador?",text:"Cuidado, un usuario administrador tendr\xe1 total dominio de la aplicaci\xf3n, contenido y usuarios, solo otorga estos permisos a usuarios que sean de tu confianza",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Administrador",cancelButtonText:"Profesor"}).then(function(t){n=t.isConfirmed?{nombre:"".concat(e.value.Enombre),apellidos:"".concat(e.value.Eapellidos),email:"".concat(e.value.Eemail),username:"".concat(e.value.EnombreUsuario),password:"".concat(e.value.Epassword),password_confirmation:"".concat(e.value.Epassword),es_admin:!0}:{nombre:"".concat(e.value.Enombre),apellidos:"".concat(e.value.Eapellidos),email:"".concat(e.value.Eemail),username:"".concat(e.value.EnombreUsuario),password:"".concat(e.value.Epassword),password_confirmation:"".concat(e.value.Epassword),es_admin:!1},I(n,"register-profesor")}))});case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(m.a)(d.a.mark(function e(t,o){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h()({title:"Se enviar\xe1 un mail al usuario para que se valide ...",icon:x.a,button:!1,allowOutsideClick:!1}),e.next=3,v.a.post(o,t).then(function(e){e.status>=200&&e.status<=205&&window.location.reload(!0)}).catch(function(e){401==e.status?h()({title:"Error acceso "+e.response.status,text:"Error, no tienes acceso a esta secci\xf3n.",icon:"error",button:"Aceptar",timer:"3000"}):h()({title:"Error interno "+e.response.status,text:"Error interno, vuelve a intentarlo en unos momentos.",icon:"error",button:"Aceptar",timer:"3000"})});case 3:case"end":return e.stop()}},e)}));return function(t,o){return e.apply(this,arguments)}}(),I=function(){var e=Object(m.a)(d.a.mark(function e(t,o){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:U.a.fire({title:"Revisi\xf3n de datos",html:"".concat(t.username,", ").concat(t.nombre,", ").concat(t.apellidos,", ").concat(t.email),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Enviar",cancelButtonText:"Cancelar"}).then(function(e){e.isConfirmed?P(t,o):h()({title:"Cancelado por el usuario"})});case 1:case"end":return e.stop()}},e)}));return function(t,o){return e.apply(this,arguments)}}(),T=function(e){h()({title:"\xbfEst\xe1s seguro?",text:"Una vez eliminado no podr\xe1s volver a recuperar el usuario",icon:"warning",buttons:!0,dangerMode:!0}).then(function(t){t&&(h()({icon:x.a,button:!1,allowOutsideClick:!1}),v.a.delete("delete-usuario/"+e).then(function(e){e.status>=200&&e.status<=205&&(JSON.parse(localStorage.getItem("user")).id_profesor?window.location.reload(!0):(localStorage.clear(),window.location.href="/"),h()({title:"Usuario eliminado",text:"  ",icon:"success",button:!1,timer:"1800"}))}).catch(function(e){401==e.status?h()({title:"Error acceso "+e.response.status,text:"Error, no tienes acceso a esta secci\xf3n.",icon:"error",button:"Aceptar",timer:"3000"}):"No es posible borrar usuarios administradores"==e.response.data.Error?h()({title:"Error "+e.response.status,text:"Solo el usuario master puede eliminar cuentas de administradores, pongase en contacto con master para eliminarlo, puede bloquear el usuario cambiando su correo electronico y contrase\xf1a mientras se atiende su solicitud",icon:"error",button:"Aceptar",timer:"5000"}):h()({title:"Error interno "+e.response.status,text:"Error interno, vuelve a intentarlo en unos momentos.",icon:"error",button:"Aceptar",timer:"3000"})}))})},J=function(){var e=Object(m.a)(d.a.mark(function e(t,o,a){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n='<input type="hidden" class="swal2-input" id=\'Egrupo\' type=\'text\' value="null">',!JSON.parse(localStorage.getItem("user")).id_profesor){e.next=11;break}if("Alumno"!=t){e.next=8;break}return e.next=6,v.a.get("grupos").then(function(e){if(e.status>=200&&e.status<=205){n='<label for=\'Egrupo\'>Grupo:</label><br>\n                        <select class="swal2-input" id="Egrupo">',n+=o?'<option value="-1">Sin grupo</option>':'<option value="-1" selected>Sin grupo</option>';for(var t=0;t<e.data.length;t++)a==e.data[t].nombre?n+='<option value="'.concat(e.data[t].id,'" selected>').concat(e.data[t].nombre,"</option>"):n+='<option value="'.concat(e.data[t].id,'">').concat(e.data[t].nombre,"</option>");n+="</select>"}}).catch(function(e){401==e.status?h()({title:"Error acceso "+e.response.status,text:"Error, no tienes acceso a esta secci\xf3n.",icon:"error",button:"Aceptar",timer:"3000"}):h()({title:"Error interno "+e.response.status,text:"Error interno, vuelve a intentarlo en unos momentos.",icon:"error",button:"Aceptar",timer:"3000"})});case 6:e.next=11;break;case 8:if("Profesor"!=t){e.next=11;break}return e.next=11,v.a.get("grupos").then(function(e){if(e.status>=200&&e.status<=205){n='<label for=\'Egrupo\'>Grupo:</label><br>\n                        <select class="swal2-input" id="Egrupo">\n                          <option value="-1" selected>Sin grupo</option>';for(var t=0;t<e.data.length;t++)n+='<option value="'.concat(e.data[t].id,'" >').concat(e.data[t].nombre,"</option>");n+="</select>"}}).catch(function(e){401==e.status?h()({title:"Error acceso "+e.response.status,text:"Error, no tienes acceso a esta secci\xf3n.",icon:"error",button:"Aceptar",timer:"3000"}):h()({title:"Error interno "+e.response.status,text:"Error interno, vuelve a intentarlo en unos momentos.",icon:"error",button:"Aceptar",timer:"3000"})});case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}},e)}));return function(t,o,a){return e.apply(this,arguments)}}(),z=function(){var e=Object(m.a)(d.a.mark(function e(t,o,a,n,r,i,l,s,c,u){var p;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(l,s,c);case 2:p=e.sent,U.a.fire({title:"Editar",html:"<label for='EnombreUsuario'>Usuario:</label>\n    <input class=\"swal2-input\" id='EnombreUsuario' type='text' value=".concat(r,">\n    <label for='Enombre'>Nombre:</label>\n    <input class=\"swal2-input\" id='Enombre' type='text' value=").concat(o,">\n    <label for='Eapellidos'>Apellidos:</label>\n    <input class=\"swal2-input\" id='Eapellidos' type='text' value=").concat(a,">\n    <label for='Eemail'>Email:</label>\n    <input class=\"swal2-input\" id='Eemail' type='email' value=").concat(n,">\n    ").concat(p,"\n    "),showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Editar",cancelButtonText:"Cancelar",focusConfirm:!1,preConfirm:function(){var e=U.a.getPopup().querySelector("#Enombre").value,t=U.a.getPopup().querySelector("#Eapellidos").value,o=U.a.getPopup().querySelector("#Eemail").value,a=U.a.getPopup().querySelector("#EnombreUsuario").value,n=U.a.getPopup().querySelector("#Egrupo").value;return e&&t&&o&&a||U.a.showValidationMessage("Alg\xfan campo obligatorio vac\xedo"),{Enombre:e,Eapellidos:t,Eemail:o,EnombreUsuario:a,Egrupo:n}}}).then(function(e){if(e.isConfirmed){h()({icon:x.a,button:!1,allowOutsideClick:!1});var t=[];t="-1"==e.value.Egrupo?{nombre:"".concat(e.value.Enombre),apellidos:"".concat(e.value.Eapellidos),email:"".concat(e.value.Eemail),username:"".concat(e.value.EnombreUsuario),id_grupo:null}:"null"!=e.value.Egrupo?{nombre:"".concat(e.value.Enombre),apellidos:"".concat(e.value.Eapellidos),email:"".concat(e.value.Eemail),username:"".concat(e.value.EnombreUsuario),id_grupo:"".concat(e.value.Egrupo)}:{nombre:"".concat(e.value.Enombre),apellidos:"".concat(e.value.Eapellidos),email:"".concat(e.value.Eemail),username:"".concat(e.value.EnombreUsuario)},v.a.put("update-usuario/"+"".concat(i),t).then(function(e){e.status>=200&&e.status<=205&&window.location.reload(!0)}).catch(function(e){401==e.status?h()({title:"Error acceso "+e.response.status,text:"Error, no tienes acceso a esta secci\xf3n.",icon:"error",button:"Aceptar",timer:"3000"}):h()({title:"Error interno "+e.response.status,text:"Error interno, vuelve a intentarlo en unos momentos.",icon:"error",button:"Aceptar",timer:"3000"})})}});case 4:case"end":return e.stop()}},e)}));return function(t,o,a,n,r,i,l,s,c,u){return e.apply(this,arguments)}}(),M={position:"bottom"},G=function(){Object(r.useContext)(E.a).token;var e=Object(r.useState)(),t=Object(u.a)(e,2),o=t[0],a=t[1],n=[];Object(r.useEffect)(Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.getItem("token")||!localStorage.getItem("user")){e.next=4;break}return JSON.parse(localStorage.getItem("user")),e.next=4,v.a.get("usuarios").then(function(e){if(e.status>=200&&e.status<=205)for(var t=0;t<e.data.length;t++)n.push({key:t,nombreUsuario:e.data[t].nombreUsuario,nombre:e.data[t].nombre,apellidos:e.data[t].apellidos,email:e.data[t].email,id_grupo:e.data[t].id_grupo,grupo:e.data[t].nombre_grupo,rol:e.data[t].tipo,id:e.data[t].id,idUsuario:e.data[t].idUsuario})}).catch(function(e){401==e.status?h()({title:"Error acceso "+e.response.status,text:"Error, no tienes acceso a esta secci\xf3n.",icon:"error",button:"Aceptar",timer:"3000"}):h()({title:"Error interno "+e.response.status,text:"Error interno, vuelve a intentarlo en unos momentos.",icon:"error",button:"Aceptar",timer:"3000"})});case 4:a(n);case 5:case"end":return e.stop()}},e)})),[]);var l=Object(r.useState)({bordered:!1,loading:!1,pagination:M,size:"Middle",showHeader:!0,rowSelection:{},scroll:void 0,hasData:!0,tableLayout:"fixed",top:"none",bottom:"bottomRight",xScroll:!1,yScroll:!1}),s=Object(u.a)(l,2),p=s[0],b=(s[1],{});p.yScroll&&(b.y=240),p.xScroll&&(b.x="100vw");var g=_.map(function(e){return Object(c.a)({},e,{ellipsis:p.ellipsis})});return"fixed"===p.xScroll&&(g[0].fixed=!0,g[g.length-1].fixed="right"),i.a.createElement(i.a.Fragment,null,i.a.createElement(y,null,function(){var e=JSON.parse(localStorage.getItem("user"));if(e&&e.id_profesor)return i.a.createElement(k,{className:"btn ",onClick:function(e){N()}},"+ Crear usuario")}(),i.a.createElement(f.a,Object.assign({},p,{pagination:{position:[p.top,p.bottom]},columns:g,dataSource:o||null,scroll:b,className:"users-table"}))))};t.default=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,null),i.a.createElement("div",{className:"container"},i.a.createElement(s.a,null),i.a.createElement(G,null)))}}}]);
//# sourceMappingURL=5.35bf5bcb.chunk.js.map